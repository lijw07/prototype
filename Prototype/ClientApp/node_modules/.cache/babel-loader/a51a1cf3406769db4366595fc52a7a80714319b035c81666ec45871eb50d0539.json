{"ast":null,"code":"import _objectSpread from\"/Users/jaili/csharpProject/Prototype/Prototype/ClientApp/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{Shield,Plus,Trash2,Key,CheckCircle2,Loader,AlertTriangle,ChevronLeft,ChevronRight,ChevronsLeft,ChevronsRight,Search}from'lucide-react';import{roleApi}from'../../services/api';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const Roles=()=>{const[roles,setRoles]=useState([]);const[loading,setLoading]=useState(false);const[showRoleForm,setShowRoleForm]=useState(false);const[editingRole,setEditingRole]=useState(null);const[isSubmitting,setIsSubmitting]=useState(false);const[submitSuccess,setSubmitSuccess]=useState(false);const[showDeleteConfirm,setShowDeleteConfirm]=useState(false);const[deletingRole,setDeletingRole]=useState(null);const[deleteSuccess,setDeleteSuccess]=useState(false);// Pagination state\nconst[currentPage,setCurrentPage]=useState(1);const[pageSize,setPageSize]=useState(4);const[totalCount,setTotalCount]=useState(0);const[totalPages,setTotalPages]=useState(0);// Search and sorting state\nconst[searchTerm,setSearchTerm]=useState('');const[sortOrder,setSortOrder]=useState('newest');const[roleForm,setRoleForm]=useState({roleName:''});const fetchRoles=async function(){let page=arguments.length>0&&arguments[0]!==undefined?arguments[0]:currentPage;let size=arguments.length>1&&arguments[1]!==undefined?arguments[1]:pageSize;setLoading(true);try{var _response$data;console.log('Fetching roles...');const response=await roleApi.getAllRoles(page,size);console.log('Fetch roles response:',response);if(response.success&&(_response$data=response.data)!==null&&_response$data!==void 0&&_response$data.data){console.log('Setting roles:',response.data.data);setRoles(response.data.data);setCurrentPage(response.data.page||page);setPageSize(response.data.pageSize||size);setTotalCount(response.data.totalCount||0);setTotalPages(response.data.totalPages||1);}else if(response.success&&response.roles){// Fallback for old API response format - use client-side pagination\nconsole.log('Setting roles (fallback):',response.roles);const startIndex=(page-1)*size;const endIndex=startIndex+size;const paginatedRoles=response.roles.slice(startIndex,endIndex);setRoles(paginatedRoles);// Set pagination values for non-paginated response\nsetTotalCount(response.roles.length);setTotalPages(Math.ceil(response.roles.length/size));setCurrentPage(page);setPageSize(size);}else{console.log('No roles returned or response not successful');}}catch(error){console.error('Failed to fetch roles:',error);}finally{setLoading(false);}};// Smart refetch that handles empty pages after deletion\nconst refetchRoles=async()=>{// First, check the current state after deletion\nconst response=await roleApi.getAllRoles(currentPage,pageSize);if(response.success){var _response$data2;let totalItems=0;if(((_response$data2=response.data)===null||_response$data2===void 0?void 0:_response$data2.totalCount)!==undefined){totalItems=response.data.totalCount;}else if(response.roles){totalItems=response.roles.length;}const newTotalPages=Math.ceil(totalItems/pageSize);// Check if current page is beyond available pages\nif(currentPage>newTotalPages&&totalItems>0){// Navigate to last available page\nsetCurrentPage(newTotalPages);await fetchRoles(newTotalPages,pageSize);}else if(totalItems===0){// If no roles at all, go to page 1\nsetCurrentPage(1);await fetchRoles(1,pageSize);}else{// Current page is valid, just refresh\nawait fetchRoles(currentPage,pageSize);}}else{// If the request failed, just refresh current page\nawait fetchRoles(currentPage,pageSize);}};// Refetch and navigate to first page (where new items should appear)\nconst refetchAndGoToFirstPage=async()=>{setCurrentPage(1);await fetchRoles(1,pageSize);};useEffect(()=>{fetchRoles(1,pageSize);},[]);// Add escape key listener to close modals\nuseEffect(()=>{const handleEscapeKey=event=>{if(event.key==='Escape'){if(showRoleForm){setShowRoleForm(false);setEditingRole(null);setRoleForm({roleName:''});}}};document.addEventListener('keydown',handleEscapeKey);return()=>{document.removeEventListener('keydown',handleEscapeKey);};},[showRoleForm]);const handleRoleSubmit=async()=>{try{setIsSubmitting(true);if(editingRole){// Update existing role\nconst response=await roleApi.updateRole(editingRole.userRoleId,{roleName:roleForm.roleName});if(response.success){setSubmitSuccess(true);refetchRoles();// Stay on current page when editing\n// Role form will be closed manually by user clicking X\n}else{alert(response.message||'Failed to update role');}}else{// Create new role\nconsole.log('Creating role with name:',roleForm.roleName);const response=await roleApi.createRole({roleName:roleForm.roleName});console.log('Create role response:',response);if(response.success){setSubmitSuccess(true);console.log('Fetching roles after creation...');refetchAndGoToFirstPage();// Go to first page where new role should appear\n// Role form will be closed manually by user clicking X\n}else{alert(response.message||'Failed to create role');}}}catch(error){console.error('Failed to save role:',error);alert(error.message||'Failed to save role');}finally{setIsSubmitting(false);}};const deleteRole=async()=>{if(!deletingRole)return;try{const response=await roleApi.deleteRole(deletingRole.userRoleId);if(response.success){setDeleteSuccess(true);refetchRoles();// Delete success modal will be closed manually by user clicking X\n}else{alert(response.message||'Failed to delete role');}}catch(error){console.error('Failed to delete role:',error);alert(error.message||'Failed to delete role');}};const confirmDeleteRole=role=>{setDeletingRole(role);setShowDeleteConfirm(true);};const openEditRole=role=>{setEditingRole(role);setRoleForm({roleName:role.role});setShowRoleForm(true);};// Filter and sort roles\nconst filteredRoles=roles.filter(role=>{const matchesSearch=searchTerm===''||role.role.toLowerCase().includes(searchTerm.toLowerCase())||role.createdBy.toLowerCase().includes(searchTerm.toLowerCase());return matchesSearch;});// Sort roles based on creation date\nconst sortedRoles=[...filteredRoles].sort((a,b)=>{const dateA=new Date(a.createdAt).getTime();const dateB=new Date(b.createdAt).getTime();return sortOrder==='newest'?dateB-dateA:dateA-dateB;});// Use filtered/sorted roles for display (when filters are active)\n// Use backend pagination when no filters are applied\nconst hasFilters=searchTerm!==''||sortOrder!=='newest';let currentRoles,displayTotalPages,displayTotalCount;if(hasFilters){// Client-side pagination for filtered results\nconst startIndex=(currentPage-1)*pageSize;const endIndex=startIndex+pageSize;currentRoles=sortedRoles.slice(startIndex,endIndex);displayTotalPages=Math.ceil(sortedRoles.length/pageSize);displayTotalCount=sortedRoles.length;}else{// Backend pagination for unfiltered results\ncurrentRoles=roles;displayTotalPages=totalPages;displayTotalCount=totalCount;}return/*#__PURE__*/_jsx(\"div\",{className:\"min-vh-100 bg-light\",style:{overflowX:'hidden'},children:/*#__PURE__*/_jsxs(\"div\",{className:\"container-fluid py-4\",style:{maxWidth:'100%'},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex align-items-center mb-2\",children:[/*#__PURE__*/_jsx(Shield,{className:\"text-primary me-3\",size:32}),/*#__PURE__*/_jsx(\"h1\",{className:\"display-5 fw-bold text-dark mb-0\",children:\"Roles\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-muted fs-6\",children:\"Manage user roles and their permissions\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"card shadow-sm border-0 rounded-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"card-body p-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between align-items-center mb-4\",children:[/*#__PURE__*/_jsxs(\"h2\",{className:\"card-title fw-bold text-dark mb-0 d-flex align-items-center\",children:[/*#__PURE__*/_jsx(Key,{className:\"text-primary me-2\",size:24}),\"System Roles\"]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowRoleForm(true),className:\"btn btn-primary rounded-3 fw-semibold d-flex align-items-center\",children:[/*#__PURE__*/_jsx(Plus,{className:\"me-2\",size:18}),/*#__PURE__*/_jsx(\"span\",{children:\"Create Role\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"row g-3 mb-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"col-md-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"position-relative\",children:[/*#__PURE__*/_jsx(Search,{className:\"position-absolute top-50 start-0 translate-middle-y ms-3 text-muted\",size:16}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control rounded-3 ps-5\",placeholder:\"Search roles...\",value:searchTerm,onChange:e=>{setSearchTerm(e.target.value);setCurrentPage(1);// Reset to first page when searching\n}})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"col-md-4\",children:/*#__PURE__*/_jsxs(\"select\",{className:\"form-select rounded-3\",value:sortOrder,onChange:e=>setSortOrder(e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"newest\",children:\"Newest First\"}),/*#__PURE__*/_jsx(\"option\",{value:\"oldest\",children:\"Oldest First\"})]})})]}),loading?/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex align-items-center text-muted\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"spinner-border spinner-border-sm me-2\",role:\"status\",children:/*#__PURE__*/_jsx(\"span\",{className:\"visually-hidden\",children:\"Loading...\"})}),\"Loading roles...\"]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"row g-3\",children:[currentRoles.map(role=>/*#__PURE__*/_jsx(\"div\",{className:\"col-12\",children:/*#__PURE__*/_jsx(\"div\",{className:\"card border border-light rounded-3 h-100\",style:{cursor:'pointer'},onClick:()=>openEditRole(role),children:/*#__PURE__*/_jsx(\"div\",{className:\"card-body p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between align-items-start mb-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-grow-1\",children:[/*#__PURE__*/_jsxs(\"h5\",{className:\"card-title fw-bold text-dark mb-1 d-flex align-items-center\",style:{wordWrap:'break-word',overflowWrap:'break-word'},children:[role.role,/*#__PURE__*/_jsx(CheckCircle2,{className:\"text-success ms-2\",size:16})]}),/*#__PURE__*/_jsxs(\"p\",{className:\"card-text text-muted small mb-2\",children:[\"Created by \",role.createdBy,\" on \",new Date(role.createdAt).toLocaleDateString()]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"d-flex flex-column gap-1\",children:/*#__PURE__*/_jsx(\"button\",{onClick:e=>{e.stopPropagation();confirmDeleteRole(role);},className:\"btn btn-outline-danger btn-sm rounded-3\",title:\"Delete Role\",children:/*#__PURE__*/_jsx(Trash2,{size:14})})})]})})})},role.userRoleId)),currentRoles.length===0&&!loading&&/*#__PURE__*/_jsx(\"div\",{className:\"col-12\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-5 text-muted\",children:[/*#__PURE__*/_jsx(Shield,{size:48,className:\"mb-3 opacity-50\"}),/*#__PURE__*/_jsx(\"p\",{children:hasFilters?'No roles match your search':'No roles configured yet'})]})})]}),displayTotalCount>4&&/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between align-items-center mt-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex align-items-center gap-3\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-muted\",children:hasFilters?\"Showing \".concat(currentRoles.length,\" of \").concat(displayTotalCount,\" roles (filtered)\"):\"Showing \".concat((currentPage-1)*pageSize+1,\" to \").concat(Math.min(currentPage*pageSize,displayTotalCount),\" of \").concat(displayTotalCount,\" roles\")}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex align-items-center gap-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-muted small\",children:\"Roles per page:\"}),/*#__PURE__*/_jsxs(\"select\",{className:\"form-select form-select-sm\",style:{width:'auto'},value:pageSize,onChange:e=>{const newPageSize=Number(e.target.value);setPageSize(newPageSize);setCurrentPage(1);if(!hasFilters){fetchRoles(1,newPageSize);}},children:[/*#__PURE__*/_jsx(\"option\",{value:4,children:\"4\"}),/*#__PURE__*/_jsx(\"option\",{value:10,children:\"10\"}),/*#__PURE__*/_jsx(\"option\",{value:20,children:\"20\"}),/*#__PURE__*/_jsx(\"option\",{value:50,children:\"50\"})]})]})]}),/*#__PURE__*/_jsx(\"nav\",{children:/*#__PURE__*/_jsxs(\"ul\",{className:\"pagination pagination-sm mb-0\",children:[/*#__PURE__*/_jsx(\"li\",{className:\"page-item \".concat(currentPage===1?'disabled':''),children:/*#__PURE__*/_jsx(\"button\",{className:\"page-link\",onClick:()=>{setCurrentPage(1);if(!hasFilters){fetchRoles(1,pageSize);}},disabled:currentPage===1,children:/*#__PURE__*/_jsx(ChevronsLeft,{size:16})})}),/*#__PURE__*/_jsx(\"li\",{className:\"page-item \".concat(currentPage===1?'disabled':''),children:/*#__PURE__*/_jsx(\"button\",{className:\"page-link\",onClick:()=>{const newPage=currentPage-1;setCurrentPage(newPage);if(!hasFilters){fetchRoles(newPage,pageSize);}},disabled:currentPage===1,children:/*#__PURE__*/_jsx(ChevronLeft,{size:16})})}),Array.from({length:Math.min(5,displayTotalPages)},(_,i)=>{let pageNum;if(displayTotalPages<=5){pageNum=i+1;}else if(currentPage<=3){pageNum=i+1;}else if(currentPage>=displayTotalPages-2){pageNum=displayTotalPages-4+i;}else{pageNum=currentPage-2+i;}return/*#__PURE__*/_jsx(\"li\",{className:\"page-item \".concat(currentPage===pageNum?'active':''),children:/*#__PURE__*/_jsx(\"button\",{className:\"page-link\",onClick:()=>{setCurrentPage(pageNum);if(!hasFilters){fetchRoles(pageNum,pageSize);}},children:pageNum})},pageNum);}),/*#__PURE__*/_jsx(\"li\",{className:\"page-item \".concat(currentPage===displayTotalPages?'disabled':''),children:/*#__PURE__*/_jsx(\"button\",{className:\"page-link\",onClick:()=>{const newPage=currentPage+1;setCurrentPage(newPage);if(!hasFilters){fetchRoles(newPage,pageSize);}},disabled:currentPage===displayTotalPages,children:/*#__PURE__*/_jsx(ChevronRight,{size:16})})}),/*#__PURE__*/_jsx(\"li\",{className:\"page-item \".concat(currentPage===displayTotalPages?'disabled':''),children:/*#__PURE__*/_jsx(\"button\",{className:\"page-link\",onClick:()=>{setCurrentPage(displayTotalPages);if(!hasFilters){fetchRoles(displayTotalPages,pageSize);}},disabled:currentPage===displayTotalPages,children:/*#__PURE__*/_jsx(ChevronsRight,{size:16})})})]})})]})]})]})}),showRoleForm&&/*#__PURE__*/_jsx(\"div\",{className:\"modal d-block\",style:{backgroundColor:'rgba(0,0,0,0.5)',position:'fixed',top:0,left:0,width:'100%',height:'100%',zIndex:1050},children:/*#__PURE__*/_jsx(\"div\",{className:\"modal-dialog modal-dialog-centered\",style:{maxWidth:'90%',margin:'1.75rem auto'},children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content border-0 rounded-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header border-0 pb-0\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"modal-title fw-bold\",children:editingRole?'Edit Role':'Create New Role'}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn-close\",onClick:()=>{setShowRoleForm(false);setEditingRole(null);setSubmitSuccess(false);setRoleForm({roleName:''});}})]}),/*#__PURE__*/_jsx(\"div\",{className:\"modal-body\",children:submitSuccess?/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-4\",children:[/*#__PURE__*/_jsx(CheckCircle2,{size:64,className:\"text-success mb-3\"}),/*#__PURE__*/_jsx(\"h4\",{className:\"text-success fw-bold\",children:editingRole?'Role Updated Successfully!':'Role Created Successfully!'}),/*#__PURE__*/_jsx(\"p\",{className:\"text-muted\",children:editingRole?'The role has been updated.':'The new role has been created.'})]}):/*#__PURE__*/_jsx(\"div\",{className:\"row g-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"col-12\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"fw-bold mb-3\",children:\"Role Information\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label fw-semibold\",children:\"Role Name\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:roleForm.roleName,onChange:e=>setRoleForm(_objectSpread(_objectSpread({},roleForm),{},{roleName:e.target.value})),className:\"form-control rounded-3\",placeholder:\"Enter role name\",disabled:isSubmitting})]})]})})}),/*#__PURE__*/_jsx(\"div\",{className:\"modal-footer border-0 pt-0\",children:!submitSuccess&&/*#__PURE__*/_jsx(\"button\",{onClick:handleRoleSubmit,className:\"btn btn-primary rounded-3 fw-semibold d-flex align-items-center\",disabled:!roleForm.roleName.trim()||isSubmitting,children:isSubmitting?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Loader,{className:\"me-2 animate-spin\",size:16}),editingRole?'Updating...':'Creating...']}):editingRole?'Update Role':'Create Role'})})]})})}),showDeleteConfirm&&deletingRole&&/*#__PURE__*/_jsx(\"div\",{className:\"modal d-block\",style:{backgroundColor:'rgba(0,0,0,0.5)',position:'fixed',top:0,left:0,width:'100%',height:'100%',zIndex:1050},children:/*#__PURE__*/_jsx(\"div\",{className:\"modal-dialog modal-dialog-centered\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content border-0 rounded-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header border-0 pb-0\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"modal-title fw-bold text-danger\",children:deleteSuccess?'Role Deleted':'Confirm Deletion'}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn-close\",onClick:()=>{setShowDeleteConfirm(false);setDeletingRole(null);setDeleteSuccess(false);}})]}),/*#__PURE__*/_jsx(\"div\",{className:\"modal-body\",children:deleteSuccess?/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-4\",children:[/*#__PURE__*/_jsx(CheckCircle2,{size:64,className:\"text-success mb-3\"}),/*#__PURE__*/_jsx(\"h4\",{className:\"text-success fw-bold\",children:\"Role Deleted Successfully!\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-muted\",children:[/*#__PURE__*/_jsx(\"strong\",{children:deletingRole.role}),\" has been permanently removed.\"]})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-4\",children:[/*#__PURE__*/_jsx(AlertTriangle,{size:64,className:\"text-warning mb-3\"}),/*#__PURE__*/_jsx(\"h4\",{className:\"fw-bold\",children:\"Are you sure you want to delete this role?\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-light rounded-3 p-3 my-3\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"fw-bold text-dark mb-1\",children:deletingRole.role}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-muted small mb-0\",children:[\"Created by \",deletingRole.createdBy,\" on \",new Date(deletingRole.createdAt).toLocaleDateString()]})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-danger small fw-semibold\",children:\"\\u26A0\\uFE0F This action cannot be undone. Users with this role may lose access permissions.\"})]})}),!deleteSuccess&&/*#__PURE__*/_jsxs(\"div\",{className:\"modal-footer border-0 pt-0\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setShowDeleteConfirm(false);setDeletingRole(null);},className:\"btn btn-secondary rounded-3 fw-semibold\",children:\"Cancel\"}),/*#__PURE__*/_jsxs(\"button\",{onClick:deleteRole,className:\"btn btn-danger rounded-3 fw-semibold d-flex align-items-center\",children:[/*#__PURE__*/_jsx(Trash2,{className:\"me-2\",size:16}),\"Delete Role\"]})]})]})})})]})});};export default Roles;","map":{"version":3,"names":["React","useState","useEffect","Shield","Plus","Trash2","Key","CheckCircle2","Loader","AlertTriangle","ChevronLeft","ChevronRight","ChevronsLeft","ChevronsRight","Search","roleApi","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Roles","roles","setRoles","loading","setLoading","showRoleForm","setShowRoleForm","editingRole","setEditingRole","isSubmitting","setIsSubmitting","submitSuccess","setSubmitSuccess","showDeleteConfirm","setShowDeleteConfirm","deletingRole","setDeletingRole","deleteSuccess","setDeleteSuccess","currentPage","setCurrentPage","pageSize","setPageSize","totalCount","setTotalCount","totalPages","setTotalPages","searchTerm","setSearchTerm","sortOrder","setSortOrder","roleForm","setRoleForm","roleName","fetchRoles","page","arguments","length","undefined","size","_response$data","console","log","response","getAllRoles","success","data","startIndex","endIndex","paginatedRoles","slice","Math","ceil","error","refetchRoles","_response$data2","totalItems","newTotalPages","refetchAndGoToFirstPage","handleEscapeKey","event","key","document","addEventListener","removeEventListener","handleRoleSubmit","updateRole","userRoleId","alert","message","createRole","deleteRole","confirmDeleteRole","role","openEditRole","filteredRoles","filter","matchesSearch","toLowerCase","includes","createdBy","sortedRoles","sort","a","b","dateA","Date","createdAt","getTime","dateB","hasFilters","currentRoles","displayTotalPages","displayTotalCount","className","style","overflowX","children","maxWidth","onClick","type","placeholder","value","onChange","e","target","map","cursor","wordWrap","overflowWrap","toLocaleDateString","stopPropagation","title","concat","min","width","newPageSize","Number","disabled","newPage","Array","from","_","i","pageNum","backgroundColor","position","top","left","height","zIndex","margin","_objectSpread","trim"],"sources":["/Users/jaili/csharpProject/Prototype/Prototype/ClientApp/src/components/roles/Roles.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Shield, Plus, Edit, Trash2, Users, Key, CheckCircle2, AlertCircle, Loader, AlertTriangle, ChevronLeft, ChevronRight, ChevronsLeft, ChevronsRight, Search } from 'lucide-react';\nimport { roleApi } from '../../services/api';\n\ninterface Role {\n    userRoleId: string;\n    role: string;\n    createdAt: string;\n    createdBy: string;\n}\n\nconst Roles: React.FC = () => {\n    const [roles, setRoles] = useState<Role[]>([]);\n    const [loading, setLoading] = useState(false);\n    const [showRoleForm, setShowRoleForm] = useState(false);\n    const [editingRole, setEditingRole] = useState<Role | null>(null);\n    const [isSubmitting, setIsSubmitting] = useState(false);\n    const [submitSuccess, setSubmitSuccess] = useState(false);\n    const [showDeleteConfirm, setShowDeleteConfirm] = useState(false);\n    const [deletingRole, setDeletingRole] = useState<Role | null>(null);\n    const [deleteSuccess, setDeleteSuccess] = useState(false);\n\n    // Pagination state\n    const [currentPage, setCurrentPage] = useState(1);\n    const [pageSize, setPageSize] = useState(4);\n    const [totalCount, setTotalCount] = useState(0);\n    const [totalPages, setTotalPages] = useState(0);\n\n    // Search and sorting state\n    const [searchTerm, setSearchTerm] = useState('');\n    const [sortOrder, setSortOrder] = useState<'newest' | 'oldest'>('newest');\n\n    const [roleForm, setRoleForm] = useState({\n        roleName: ''\n    });\n\n    const fetchRoles = async (page: number = currentPage, size: number = pageSize) => {\n        setLoading(true);\n        try {\n            console.log('Fetching roles...');\n            const response = await roleApi.getAllRoles(page, size);\n            console.log('Fetch roles response:', response);\n            if (response.success && response.data?.data) {\n                console.log('Setting roles:', response.data.data);\n                setRoles(response.data.data);\n                setCurrentPage(response.data.page || page);\n                setPageSize(response.data.pageSize || size);\n                setTotalCount(response.data.totalCount || 0);\n                setTotalPages(response.data.totalPages || 1);\n            } else if (response.success && response.roles) {\n                // Fallback for old API response format - use client-side pagination\n                console.log('Setting roles (fallback):', response.roles);\n                const startIndex = (page - 1) * size;\n                const endIndex = startIndex + size;\n                const paginatedRoles = response.roles.slice(startIndex, endIndex);\n                setRoles(paginatedRoles);\n                // Set pagination values for non-paginated response\n                setTotalCount(response.roles.length);\n                setTotalPages(Math.ceil(response.roles.length / size));\n                setCurrentPage(page);\n                setPageSize(size);\n            } else {\n                console.log('No roles returned or response not successful');\n            }\n        } catch (error) {\n            console.error('Failed to fetch roles:', error);\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    // Smart refetch that handles empty pages after deletion\n    const refetchRoles = async () => {\n        // First, check the current state after deletion\n        const response = await roleApi.getAllRoles(currentPage, pageSize);\n        if (response.success) {\n            let totalItems = 0;\n            if (response.data?.totalCount !== undefined) {\n                totalItems = response.data.totalCount;\n            } else if (response.roles) {\n                totalItems = response.roles.length;\n            }\n            \n            const newTotalPages = Math.ceil(totalItems / pageSize);\n            \n            // Check if current page is beyond available pages\n            if (currentPage > newTotalPages && totalItems > 0) {\n                // Navigate to last available page\n                setCurrentPage(newTotalPages);\n                await fetchRoles(newTotalPages, pageSize);\n            } else if (totalItems === 0) {\n                // If no roles at all, go to page 1\n                setCurrentPage(1);\n                await fetchRoles(1, pageSize);\n            } else {\n                // Current page is valid, just refresh\n                await fetchRoles(currentPage, pageSize);\n            }\n        } else {\n            // If the request failed, just refresh current page\n            await fetchRoles(currentPage, pageSize);\n        }\n    };\n\n    // Refetch and navigate to first page (where new items should appear)\n    const refetchAndGoToFirstPage = async () => {\n        setCurrentPage(1);\n        await fetchRoles(1, pageSize);\n    };\n\n    useEffect(() => {\n        fetchRoles(1, pageSize);\n    }, []);\n\n    // Add escape key listener to close modals\n    useEffect(() => {\n        const handleEscapeKey = (event: KeyboardEvent) => {\n            if (event.key === 'Escape') {\n                if (showRoleForm) {\n                    setShowRoleForm(false);\n                    setEditingRole(null);\n                    setRoleForm({ roleName: '' });\n                }\n            }\n        };\n\n        document.addEventListener('keydown', handleEscapeKey);\n        return () => {\n            document.removeEventListener('keydown', handleEscapeKey);\n        };\n    }, [showRoleForm]);\n\n    const handleRoleSubmit = async () => {\n        try {\n            setIsSubmitting(true);\n            if (editingRole) {\n                // Update existing role\n                const response = await roleApi.updateRole(editingRole.userRoleId, { roleName: roleForm.roleName });\n                if (response.success) {\n                    setSubmitSuccess(true);\n                    refetchRoles(); // Stay on current page when editing\n                    \n                    // Role form will be closed manually by user clicking X\n                } else {\n                    alert(response.message || 'Failed to update role');\n                }\n            } else {\n                // Create new role\n                console.log('Creating role with name:', roleForm.roleName);\n                const response = await roleApi.createRole({ roleName: roleForm.roleName });\n                console.log('Create role response:', response);\n                if (response.success) {\n                    setSubmitSuccess(true);\n                    console.log('Fetching roles after creation...');\n                    refetchAndGoToFirstPage(); // Go to first page where new role should appear\n                    \n                    // Role form will be closed manually by user clicking X\n                } else {\n                    alert(response.message || 'Failed to create role');\n                }\n            }\n        } catch (error: any) {\n            console.error('Failed to save role:', error);\n            alert(error.message || 'Failed to save role');\n        } finally {\n            setIsSubmitting(false);\n        }\n    };\n\n    const deleteRole = async () => {\n        if (!deletingRole) return;\n\n        try {\n            const response = await roleApi.deleteRole(deletingRole.userRoleId);\n            if (response.success) {\n                setDeleteSuccess(true);\n                refetchRoles();\n                \n                // Delete success modal will be closed manually by user clicking X\n            } else {\n                alert(response.message || 'Failed to delete role');\n            }\n        } catch (error: any) {\n            console.error('Failed to delete role:', error);\n            alert(error.message || 'Failed to delete role');\n        }\n    };\n\n    const confirmDeleteRole = (role: Role) => {\n        setDeletingRole(role);\n        setShowDeleteConfirm(true);\n    };\n\n\n    const openEditRole = (role: Role) => {\n        setEditingRole(role);\n        setRoleForm({\n            roleName: role.role\n        });\n        setShowRoleForm(true);\n    };\n\n    // Filter and sort roles\n    const filteredRoles = roles.filter(role => {\n        const matchesSearch = searchTerm === '' || \n                             role.role.toLowerCase().includes(searchTerm.toLowerCase()) ||\n                             role.createdBy.toLowerCase().includes(searchTerm.toLowerCase());\n        return matchesSearch;\n    });\n\n    // Sort roles based on creation date\n    const sortedRoles = [...filteredRoles].sort((a, b) => {\n        const dateA = new Date(a.createdAt).getTime();\n        const dateB = new Date(b.createdAt).getTime();\n        return sortOrder === 'newest' ? dateB - dateA : dateA - dateB;\n    });\n\n    // Use filtered/sorted roles for display (when filters are active)\n    // Use backend pagination when no filters are applied\n    const hasFilters = searchTerm !== '' || sortOrder !== 'newest';\n    \n    let currentRoles: Role[], displayTotalPages: number, displayTotalCount: number;\n    if (hasFilters) {\n        // Client-side pagination for filtered results\n        const startIndex = (currentPage - 1) * pageSize;\n        const endIndex = startIndex + pageSize;\n        currentRoles = sortedRoles.slice(startIndex, endIndex);\n        displayTotalPages = Math.ceil(sortedRoles.length / pageSize);\n        displayTotalCount = sortedRoles.length;\n    } else {\n        // Backend pagination for unfiltered results\n        currentRoles = roles;\n        displayTotalPages = totalPages;\n        displayTotalCount = totalCount;\n    }\n\n    return (\n        <div className=\"min-vh-100 bg-light\" style={{overflowX: 'hidden'}}>\n            <div className=\"container-fluid py-4\" style={{maxWidth: '100%'}}>\n                {/* Header */}\n                <div className=\"mb-4\">\n                    <div className=\"d-flex align-items-center mb-2\">\n                        <Shield className=\"text-primary me-3\" size={32} />\n                        <h1 className=\"display-5 fw-bold text-dark mb-0\">Roles</h1>\n                    </div>\n                    <p className=\"text-muted fs-6\">Manage user roles and their permissions</p>\n                </div>\n\n                {/* Roles */}\n                <div className=\"card shadow-sm border-0 rounded-4\">\n                    <div className=\"card-body p-4\">\n                        <div className=\"d-flex justify-content-between align-items-center mb-4\">\n                            <h2 className=\"card-title fw-bold text-dark mb-0 d-flex align-items-center\">\n                                <Key className=\"text-primary me-2\" size={24} />\n                                System Roles\n                            </h2>\n                            <button\n                                onClick={() => setShowRoleForm(true)}\n                                className=\"btn btn-primary rounded-3 fw-semibold d-flex align-items-center\"\n                            >\n                                <Plus className=\"me-2\" size={18} />\n                                <span>Create Role</span>\n                            </button>\n                        </div>\n\n                        {/* Search and Sort Controls */}\n                        <div className=\"row g-3 mb-4\">\n                            <div className=\"col-md-8\">\n                                <div className=\"position-relative\">\n                                    <Search className=\"position-absolute top-50 start-0 translate-middle-y ms-3 text-muted\" size={16} />\n                                    <input\n                                        type=\"text\"\n                                        className=\"form-control rounded-3 ps-5\"\n                                        placeholder=\"Search roles...\"\n                                        value={searchTerm}\n                                        onChange={(e) => {\n                                            setSearchTerm(e.target.value);\n                                            setCurrentPage(1); // Reset to first page when searching\n                                        }}\n                                    />\n                                </div>\n                            </div>\n                            <div className=\"col-md-4\">\n                                <select\n                                    className=\"form-select rounded-3\"\n                                    value={sortOrder}\n                                    onChange={(e) => setSortOrder(e.target.value as 'newest' | 'oldest')}\n                                >\n                                    <option value=\"newest\">Newest First</option>\n                                    <option value=\"oldest\">Oldest First</option>\n                                </select>\n                            </div>\n                        </div>\n\n                        {loading ? (\n                            <div className=\"d-flex align-items-center text-muted\">\n                                <div className=\"spinner-border spinner-border-sm me-2\" role=\"status\">\n                                    <span className=\"visually-hidden\">Loading...</span>\n                                </div>\n                                Loading roles...\n                            </div>\n                        ) : (\n                            <>\n                                <div className=\"row g-3\">\n                                    {currentRoles.map((role) => (\n                                        <div key={role.userRoleId} className=\"col-12\">\n                                            <div \n                                                className=\"card border border-light rounded-3 h-100\" \n                                                style={{cursor: 'pointer'}}\n                                                onClick={() => openEditRole(role)}\n                                            >\n                                                <div className=\"card-body p-4\">\n                                                    <div className=\"d-flex justify-content-between align-items-start mb-3\">\n                                                        <div className=\"flex-grow-1\">\n                                                            <h5 className=\"card-title fw-bold text-dark mb-1 d-flex align-items-center\" style={{wordWrap: 'break-word', overflowWrap: 'break-word'}}>\n                                                                {role.role}\n                                                                <CheckCircle2 className=\"text-success ms-2\" size={16} />\n                                                            </h5>\n                                                            <p className=\"card-text text-muted small mb-2\">\n                                                                Created by {role.createdBy} on {new Date(role.createdAt).toLocaleDateString()}\n                                                            </p>\n                                                        </div>\n                                                        <div className=\"d-flex flex-column gap-1\">\n                                                            <button\n                                                                onClick={(e) => {\n                                                                    e.stopPropagation();\n                                                                    confirmDeleteRole(role);\n                                                                }}\n                                                                className=\"btn btn-outline-danger btn-sm rounded-3\"\n                                                                title=\"Delete Role\"\n                                                            >\n                                                                <Trash2 size={14} />\n                                                            </button>\n                                                        </div>\n                                                    </div>\n                                                </div>\n                                            </div>\n                                        </div>\n                                    ))}\n                                    {currentRoles.length === 0 && !loading && (\n                                        <div className=\"col-12\">\n                                            <div className=\"text-center py-5 text-muted\">\n                                                <Shield size={48} className=\"mb-3 opacity-50\" />\n                                                <p>{hasFilters ? 'No roles match your search' : 'No roles configured yet'}</p>\n                                            </div>\n                                        </div>\n                                    )}\n                                </div>\n\n                                {/* Pagination */}\n                                {displayTotalCount > 4 && (\n                            <div className=\"d-flex justify-content-between align-items-center mt-4\">\n                                <div className=\"d-flex align-items-center gap-3\">\n                                    <span className=\"text-muted\">\n                                        {hasFilters ? (\n                                            `Showing ${currentRoles.length} of ${displayTotalCount} roles (filtered)`\n                                        ) : (\n                                            `Showing ${((currentPage - 1) * pageSize) + 1} to ${Math.min(currentPage * pageSize, displayTotalCount)} of ${displayTotalCount} roles`\n                                        )}\n                                    </span>\n                                    <div className=\"d-flex align-items-center gap-2\">\n                                        <span className=\"text-muted small\">Roles per page:</span>\n                                        <select \n                                            className=\"form-select form-select-sm\" \n                                            style={{width: 'auto'}}\n                                            value={pageSize}\n                                            onChange={(e) => {\n                                                const newPageSize = Number(e.target.value);\n                                                setPageSize(newPageSize);\n                                                setCurrentPage(1);\n                                                if (!hasFilters) {\n                                                    fetchRoles(1, newPageSize);\n                                                }\n                                            }}\n                                        >\n                                            <option value={4}>4</option>\n                                            <option value={10}>10</option>\n                                            <option value={20}>20</option>\n                                            <option value={50}>50</option>\n                                        </select>\n                                    </div>\n                                </div>\n                                \n                                <nav>\n                                    <ul className=\"pagination pagination-sm mb-0\">\n                                        <li className={`page-item ${currentPage === 1 ? 'disabled' : ''}`}>\n                                            <button \n                                                className=\"page-link\" \n                                                onClick={() => {\n                                                    setCurrentPage(1);\n                                                    if (!hasFilters) {\n                                                        fetchRoles(1, pageSize);\n                                                    }\n                                                }}\n                                                disabled={currentPage === 1}\n                                            >\n                                                <ChevronsLeft size={16} />\n                                            </button>\n                                        </li>\n                                        <li className={`page-item ${currentPage === 1 ? 'disabled' : ''}`}>\n                                            <button \n                                                className=\"page-link\" \n                                                onClick={() => {\n                                                    const newPage = currentPage - 1;\n                                                    setCurrentPage(newPage);\n                                                    if (!hasFilters) {\n                                                        fetchRoles(newPage, pageSize);\n                                                    }\n                                                }}\n                                                disabled={currentPage === 1}\n                                            >\n                                                <ChevronLeft size={16} />\n                                            </button>\n                                        </li>\n                                        \n                                        {/* Page numbers */}\n                                        {Array.from({ length: Math.min(5, displayTotalPages) }, (_, i) => {\n                                            let pageNum: number;\n                                            if (displayTotalPages <= 5) {\n                                                pageNum = i + 1;\n                                            } else if (currentPage <= 3) {\n                                                pageNum = i + 1;\n                                            } else if (currentPage >= displayTotalPages - 2) {\n                                                pageNum = displayTotalPages - 4 + i;\n                                            } else {\n                                                pageNum = currentPage - 2 + i;\n                                            }\n                                            \n                                            return (\n                                                <li key={pageNum} className={`page-item ${currentPage === pageNum ? 'active' : ''}`}>\n                                                    <button \n                                                        className=\"page-link\" \n                                                        onClick={() => {\n                                                            setCurrentPage(pageNum);\n                                                            if (!hasFilters) {\n                                                                fetchRoles(pageNum, pageSize);\n                                                            }\n                                                        }}\n                                                    >\n                                                        {pageNum}\n                                                    </button>\n                                                </li>\n                                            );\n                                        })}\n                                        \n                                        <li className={`page-item ${currentPage === displayTotalPages ? 'disabled' : ''}`}>\n                                            <button \n                                                className=\"page-link\" \n                                                onClick={() => {\n                                                    const newPage = currentPage + 1;\n                                                    setCurrentPage(newPage);\n                                                    if (!hasFilters) {\n                                                        fetchRoles(newPage, pageSize);\n                                                    }\n                                                }}\n                                                disabled={currentPage === displayTotalPages}\n                                            >\n                                                <ChevronRight size={16} />\n                                            </button>\n                                        </li>\n                                        <li className={`page-item ${currentPage === displayTotalPages ? 'disabled' : ''}`}>\n                                            <button \n                                                className=\"page-link\" \n                                                onClick={() => {\n                                                    setCurrentPage(displayTotalPages);\n                                                    if (!hasFilters) {\n                                                        fetchRoles(displayTotalPages, pageSize);\n                                                    }\n                                                }}\n                                                disabled={currentPage === displayTotalPages}\n                                            >\n                                                <ChevronsRight size={16} />\n                                            </button>\n                                        </li>\n                                    </ul>\n                                </nav>\n                            </div>\n                        )}\n                            </>\n                        )}\n                    </div>\n                </div>\n\n                {/* Role Form Modal */}\n                {showRoleForm && (\n                    <div className=\"modal d-block\" style={{backgroundColor: 'rgba(0,0,0,0.5)', position: 'fixed', top: 0, left: 0, width: '100%', height: '100%', zIndex: 1050}}>\n                        <div className=\"modal-dialog modal-dialog-centered\" style={{maxWidth: '90%', margin: '1.75rem auto'}}>\n                            <div className=\"modal-content border-0 rounded-4\">\n                                <div className=\"modal-header border-0 pb-0\">\n                                    <h3 className=\"modal-title fw-bold\">\n                                        {editingRole ? 'Edit Role' : 'Create New Role'}\n                                    </h3>\n                                    <button\n                                        type=\"button\"\n                                        className=\"btn-close\"\n                                        onClick={() => {\n                                            setShowRoleForm(false);\n                                            setEditingRole(null);\n                                            setSubmitSuccess(false);\n                                            setRoleForm({\n                                                roleName: ''\n                                            });\n                                        }}\n                                    ></button>\n                                </div>\n                                <div className=\"modal-body\">\n                                    {submitSuccess ? (\n                                        <div className=\"text-center py-4\">\n                                            <CheckCircle2 size={64} className=\"text-success mb-3\" />\n                                            <h4 className=\"text-success fw-bold\">\n                                                {editingRole ? 'Role Updated Successfully!' : 'Role Created Successfully!'}\n                                            </h4>\n                                            <p className=\"text-muted\">\n                                                {editingRole ? 'The role has been updated.' : 'The new role has been created.'}\n                                            </p>\n                                        </div>\n                                    ) : (\n                                        <div className=\"row g-4\">\n                                            <div className=\"col-12\">\n                                                <h5 className=\"fw-bold mb-3\">Role Information</h5>\n                                                <div className=\"mb-3\">\n                                                    <label className=\"form-label fw-semibold\">Role Name</label>\n                                                    <input\n                                                        type=\"text\"\n                                                        value={roleForm.roleName}\n                                                        onChange={(e) => setRoleForm({...roleForm, roleName: e.target.value})}\n                                                        className=\"form-control rounded-3\"\n                                                        placeholder=\"Enter role name\"\n                                                        disabled={isSubmitting}\n                                                    />\n                                                </div>\n                                            </div>\n                                        </div>\n                                    )}\n                                </div>\n                                <div className=\"modal-footer border-0 pt-0\">\n                                    {!submitSuccess && (\n                                        <button\n                                            onClick={handleRoleSubmit}\n                                            className=\"btn btn-primary rounded-3 fw-semibold d-flex align-items-center\"\n                                            disabled={!roleForm.roleName.trim() || isSubmitting}\n                                        >\n                                            {isSubmitting ? (\n                                                <>\n                                                    <Loader className=\"me-2 animate-spin\" size={16} />\n                                                    {editingRole ? 'Updating...' : 'Creating...'}\n                                                </>\n                                            ) : (\n                                                editingRole ? 'Update Role' : 'Create Role'\n                                            )}\n                                        </button>\n                                    )}\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                )}\n\n                {/* Delete Confirmation Modal */}\n                {showDeleteConfirm && deletingRole && (\n                    <div className=\"modal d-block\" style={{backgroundColor: 'rgba(0,0,0,0.5)', position: 'fixed', top: 0, left: 0, width: '100%', height: '100%', zIndex: 1050}}>\n                        <div className=\"modal-dialog modal-dialog-centered\">\n                            <div className=\"modal-content border-0 rounded-4\">\n                                <div className=\"modal-header border-0 pb-0\">\n                                    <h3 className=\"modal-title fw-bold text-danger\">\n                                        {deleteSuccess ? 'Role Deleted' : 'Confirm Deletion'}\n                                    </h3>\n                                    <button\n                                        type=\"button\"\n                                        className=\"btn-close\"\n                                        onClick={() => {\n                                            setShowDeleteConfirm(false);\n                                            setDeletingRole(null);\n                                            setDeleteSuccess(false);\n                                        }}\n                                    ></button>\n                                </div>\n                                <div className=\"modal-body\">\n                                    {deleteSuccess ? (\n                                        <div className=\"text-center py-4\">\n                                            <CheckCircle2 size={64} className=\"text-success mb-3\" />\n                                            <h4 className=\"text-success fw-bold\">Role Deleted Successfully!</h4>\n                                            <p className=\"text-muted\">\n                                                <strong>{deletingRole.role}</strong> has been permanently removed.\n                                            </p>\n                                        </div>\n                                    ) : (\n                                        <div className=\"text-center py-4\">\n                                            <AlertTriangle size={64} className=\"text-warning mb-3\" />\n                                            <h4 className=\"fw-bold\">Are you sure you want to delete this role?</h4>\n                                            <div className=\"bg-light rounded-3 p-3 my-3\">\n                                                <h5 className=\"fw-bold text-dark mb-1\">{deletingRole.role}</h5>\n                                                <p className=\"text-muted small mb-0\">Created by {deletingRole.createdBy} on {new Date(deletingRole.createdAt).toLocaleDateString()}</p>\n                                            </div>\n                                            <p className=\"text-danger small fw-semibold\">\n                                                 This action cannot be undone. Users with this role may lose access permissions.\n                                            </p>\n                                        </div>\n                                    )}\n                                </div>\n                                {!deleteSuccess && (\n                                    <div className=\"modal-footer border-0 pt-0\">\n                                        <button\n                                            onClick={() => {\n                                                setShowDeleteConfirm(false);\n                                                setDeletingRole(null);\n                                            }}\n                                            className=\"btn btn-secondary rounded-3 fw-semibold\"\n                                        >\n                                            Cancel\n                                        </button>\n                                        <button\n                                            onClick={deleteRole}\n                                            className=\"btn btn-danger rounded-3 fw-semibold d-flex align-items-center\"\n                                        >\n                                            <Trash2 className=\"me-2\" size={16} />\n                                            Delete Role\n                                        </button>\n                                    </div>\n                                )}\n                            </div>\n                        </div>\n                    </div>\n                )}\n            </div>\n        </div>\n    );\n};\n\nexport default Roles;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}