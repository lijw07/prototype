{"ast":null,"code":"import _objectSpread from\"/Users/jaili/csharpProject/Prototype/Prototype/ClientApp/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{Shield,Plus,Trash2,Key,CheckCircle2,AlertCircle,Loader,AlertTriangle,ChevronLeft,ChevronRight,ChevronsLeft,ChevronsRight,Search}from'lucide-react';import{roleApi}from'../../services/api';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const Roles=()=>{const[roles,setRoles]=useState([]);const[allRoles,setAllRoles]=useState([]);// Store all roles for client-side operations\nconst[loading,setLoading]=useState(false);const[showRoleForm,setShowRoleForm]=useState(false);const[editingRole,setEditingRole]=useState(null);const[isSubmitting,setIsSubmitting]=useState(false);const[submitSuccess,setSubmitSuccess]=useState(false);const[showDeleteConfirm,setShowDeleteConfirm]=useState(false);const[deletingRole,setDeletingRole]=useState(null);const[deleteSuccess,setDeleteSuccess]=useState(false);const[deletionConstraints,setDeletionConstraints]=useState(null);const[loadingConstraints,setLoadingConstraints]=useState(false);// Pagination state\nconst[currentPage,setCurrentPage]=useState(1);const[pageSize,setPageSize]=useState(4);const[totalCount,setTotalCount]=useState(0);const[totalPages,setTotalPages]=useState(0);// Search and sorting state\nconst[searchTerm,setSearchTerm]=useState('');const[sortOrder,setSortOrder]=useState('newest');const[roleForm,setRoleForm]=useState({roleName:''});const fetchAllRoles=async()=>{try{var _response$data;// Fetch all roles by requesting a large page size\nconst response=await roleApi.getAllRoles(1,1000);// Large enough to get all\nif(response.success&&(_response$data=response.data)!==null&&_response$data!==void 0&&_response$data.data){setAllRoles(response.data.data);return response.data.data;}else if(response.success&&response.roles){setAllRoles(response.roles);return response.roles;}return[];}catch(error){console.error('Failed to fetch all roles:',error);return[];}};const fetchRoles=async function(){let page=arguments.length>0&&arguments[0]!==undefined?arguments[0]:currentPage;let size=arguments.length>1&&arguments[1]!==undefined?arguments[1]:pageSize;setLoading(true);try{var _response$data2;console.log('Fetching roles...');const response=await roleApi.getAllRoles(page,size);console.log('Fetch roles response:',response);if(response.success&&(_response$data2=response.data)!==null&&_response$data2!==void 0&&_response$data2.data){console.log('Setting roles:',response.data.data);setRoles(response.data.data);setCurrentPage(response.data.page||page);setPageSize(response.data.pageSize||size);setTotalCount(response.data.totalCount||0);setTotalPages(response.data.totalPages||1);}else if(response.success&&response.roles){// Fallback for old API response format - use client-side pagination\nconsole.log('Setting roles (fallback):',response.roles);const startIndex=(page-1)*size;const endIndex=startIndex+size;const paginatedRoles=response.roles.slice(startIndex,endIndex);setRoles(paginatedRoles);// Set pagination values for non-paginated response\nsetTotalCount(response.roles.length);setTotalPages(Math.ceil(response.roles.length/size));setCurrentPage(page);setPageSize(size);}else{console.log('No roles returned or response not successful');}}catch(error){console.error('Failed to fetch roles:',error);}finally{setLoading(false);}};// Smart refetch that handles empty pages after deletion\nconst refetchRoles=async()=>{// First, check the current state after deletion\nconst response=await roleApi.getAllRoles(currentPage,pageSize);if(response.success){var _response$data3;let totalItems=0;if(((_response$data3=response.data)===null||_response$data3===void 0?void 0:_response$data3.totalCount)!==undefined){totalItems=response.data.totalCount;}else if(response.roles){totalItems=response.roles.length;}const newTotalPages=Math.ceil(totalItems/pageSize);// Check if current page is beyond available pages\nif(currentPage>newTotalPages&&totalItems>0){// Navigate to last available page\nsetCurrentPage(newTotalPages);await fetchRoles(newTotalPages,pageSize);}else if(totalItems===0){// If no roles at all, go to page 1\nsetCurrentPage(1);await fetchRoles(1,pageSize);}else{// Current page is valid, just refresh\nawait fetchRoles(currentPage,pageSize);}}else{// If the request failed, just refresh current page\nawait fetchRoles(currentPage,pageSize);}// Also refresh all roles\nawait fetchAllRoles();};// Refetch and navigate to first page (where new items should appear)\nconst refetchAndGoToFirstPage=async()=>{setCurrentPage(1);await fetchRoles(1,pageSize);// Also refresh all roles\nawait fetchAllRoles();};useEffect(()=>{fetchRoles(1,pageSize);// Also fetch all roles for client-side operations\nfetchAllRoles();},[]);// Add escape key listener to close modals\nuseEffect(()=>{const handleEscapeKey=event=>{if(event.key==='Escape'){if(showRoleForm){setShowRoleForm(false);setEditingRole(null);setRoleForm({roleName:''});}}};document.addEventListener('keydown',handleEscapeKey);return()=>{document.removeEventListener('keydown',handleEscapeKey);};},[showRoleForm]);const handleRoleSubmit=async()=>{try{setIsSubmitting(true);if(editingRole){// Update existing role\nconst response=await roleApi.updateRole(editingRole.userRoleId,{roleName:roleForm.roleName});if(response.success){setSubmitSuccess(true);refetchRoles();// Stay on current page when editing\n// Role form will be closed manually by user clicking X\n}else{alert(response.message||'Failed to update role');}}else{// Create new role\nconsole.log('Creating role with name:',roleForm.roleName);const response=await roleApi.createRole({roleName:roleForm.roleName});console.log('Create role response:',response);if(response.success){setSubmitSuccess(true);console.log('Fetching roles after creation...');refetchAndGoToFirstPage();// Go to first page where new role should appear\n// Role form will be closed manually by user clicking X\n}else{alert(response.message||'Failed to create role');}}}catch(error){console.error('Failed to save role:',error);alert(error.message||'Failed to save role');}finally{setIsSubmitting(false);}};const deleteRole=async()=>{if(!deletingRole)return;try{const response=await roleApi.deleteRole(deletingRole.userRoleId);if(response.success){setDeleteSuccess(true);refetchRoles();// Delete success modal will be closed manually by user clicking X\n}else{alert(response.message||'Failed to delete role');}}catch(error){console.error('Failed to delete role:',error);alert(error.message||'Failed to delete role');}};const confirmDeleteRole=async role=>{setDeletingRole(role);setShowDeleteConfirm(true);setLoadingConstraints(true);setDeletionConstraints(null);try{const response=await roleApi.getRoleDeletionConstraints(role.userRoleId);if(response.success){setDeletionConstraints({canDelete:response.canDelete,usersCount:response.usersCount,temporaryUsersCount:response.temporaryUsersCount,constraintMessage:response.constraintMessage,roleName:response.roleName});}}catch(error){console.error('Failed to fetch deletion constraints:',error);setDeletionConstraints({canDelete:false,usersCount:0,temporaryUsersCount:0,constraintMessage:\"Unable to check role constraints. Please try again.\",roleName:role.role});}finally{setLoadingConstraints(false);}};const openEditRole=role=>{setEditingRole(role);setRoleForm({roleName:role.role});setShowRoleForm(true);};// Use filtered/sorted roles for display (when filters are active)\n// Use backend pagination when no filters are applied\nconst hasFilters=searchTerm!==''||sortOrder==='oldest';// Use allRoles for filtering/sorting, roles for backend pagination\nconst sourceRoles=hasFilters?allRoles:roles;// Filter and sort roles\nconst filteredRoles=sourceRoles.filter(role=>{const matchesSearch=searchTerm===''||role.role.toLowerCase().includes(searchTerm.toLowerCase())||role.createdBy.toLowerCase().includes(searchTerm.toLowerCase());return matchesSearch;});// Sort roles based on creation date\nconst sortedRoles=[...filteredRoles].sort((a,b)=>{const dateA=new Date(a.createdAt).getTime();const dateB=new Date(b.createdAt).getTime();return sortOrder==='newest'?dateB-dateA:dateA-dateB;});let currentRoles,displayTotalPages,displayTotalCount;if(hasFilters){// Client-side pagination for filtered results\nconst startIndex=(currentPage-1)*pageSize;const endIndex=startIndex+pageSize;currentRoles=sortedRoles.slice(startIndex,endIndex);displayTotalPages=Math.ceil(sortedRoles.length/pageSize);displayTotalCount=sortedRoles.length;}else{// Backend pagination for unfiltered results\ncurrentRoles=roles;displayTotalPages=totalPages;displayTotalCount=totalCount;}return/*#__PURE__*/_jsx(\"div\",{className:\"min-vh-100 bg-light\",style:{overflowX:'hidden'},children:/*#__PURE__*/_jsxs(\"div\",{className:\"container-fluid py-4\",style:{maxWidth:'100%'},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex align-items-center mb-2\",children:[/*#__PURE__*/_jsx(Shield,{className:\"text-primary me-3\",size:32}),/*#__PURE__*/_jsx(\"h1\",{className:\"display-5 fw-bold text-dark mb-0\",children:\"Roles\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-muted fs-6\",children:\"Manage user roles and their permissions\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"card shadow-sm border-0 rounded-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"card-body p-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between align-items-center mb-4\",children:[/*#__PURE__*/_jsxs(\"h2\",{className:\"card-title fw-bold text-dark mb-0 d-flex align-items-center\",children:[/*#__PURE__*/_jsx(Key,{className:\"text-primary me-2\",size:24}),\"System Roles\"]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowRoleForm(true),className:\"btn btn-primary rounded-3 fw-semibold d-flex align-items-center\",children:[/*#__PURE__*/_jsx(Plus,{className:\"me-2\",size:18}),/*#__PURE__*/_jsx(\"span\",{children:\"Create Role\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"row g-3 mb-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"col-md-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"position-relative\",children:[/*#__PURE__*/_jsx(Search,{className:\"position-absolute top-50 start-0 translate-middle-y ms-3 text-muted\",size:16}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control rounded-3 ps-5\",placeholder:\"Search roles...\",value:searchTerm,onChange:e=>{setSearchTerm(e.target.value);setCurrentPage(1);// Reset to first page when searching\n}})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"col-md-4\",children:/*#__PURE__*/_jsxs(\"select\",{className:\"form-select rounded-3\",value:sortOrder,onChange:async e=>{const newSortOrder=e.target.value;setSortOrder(newSortOrder);setCurrentPage(1);// Reset to first page when sorting changes\n// If switching to oldest first and we don't have all roles, fetch them\nif(newSortOrder==='oldest'&&allRoles.length===0){await fetchAllRoles();}},children:[/*#__PURE__*/_jsx(\"option\",{value:\"newest\",children:\"Newest First\"}),/*#__PURE__*/_jsx(\"option\",{value:\"oldest\",children:\"Oldest First\"})]})})]}),loading?/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex align-items-center text-muted\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"spinner-border spinner-border-sm me-2\",role:\"status\",children:/*#__PURE__*/_jsx(\"span\",{className:\"visually-hidden\",children:\"Loading...\"})}),\"Loading roles...\"]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"row g-3\",children:[currentRoles.map(role=>/*#__PURE__*/_jsx(\"div\",{className:\"col-12\",children:/*#__PURE__*/_jsx(\"div\",{className:\"card border border-light rounded-3 h-100\",style:{cursor:'pointer'},onClick:()=>openEditRole(role),children:/*#__PURE__*/_jsx(\"div\",{className:\"card-body p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between align-items-start mb-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-grow-1\",children:[/*#__PURE__*/_jsxs(\"h5\",{className:\"card-title fw-bold text-dark mb-1 d-flex align-items-center\",style:{wordWrap:'break-word',overflowWrap:'break-word'},children:[role.role,/*#__PURE__*/_jsx(CheckCircle2,{className:\"text-success ms-2\",size:16})]}),/*#__PURE__*/_jsxs(\"p\",{className:\"card-text text-muted small mb-2\",children:[\"Created by \",role.createdBy,\" on \",new Date(role.createdAt).toLocaleDateString()]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"d-flex flex-column gap-1\",children:/*#__PURE__*/_jsx(\"button\",{onClick:e=>{e.stopPropagation();confirmDeleteRole(role);},className:\"btn btn-outline-danger btn-sm rounded-3\",title:\"Delete Role\",children:/*#__PURE__*/_jsx(Trash2,{size:14})})})]})})})},role.userRoleId)),currentRoles.length===0&&!loading&&/*#__PURE__*/_jsx(\"div\",{className:\"col-12\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-5 text-muted\",children:[/*#__PURE__*/_jsx(Shield,{size:48,className:\"mb-3 opacity-50\"}),/*#__PURE__*/_jsx(\"p\",{children:hasFilters?'No roles match your search':'No roles configured yet'})]})})]}),displayTotalCount>4&&/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between align-items-center mt-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex align-items-center gap-3\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-muted\",children:hasFilters?\"Showing \".concat(currentRoles.length,\" of \").concat(displayTotalCount,\" roles (filtered)\"):\"Showing \".concat((currentPage-1)*pageSize+1,\" to \").concat(Math.min(currentPage*pageSize,displayTotalCount),\" of \").concat(displayTotalCount,\" roles\")}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex align-items-center gap-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-muted small\",children:\"Roles per page:\"}),/*#__PURE__*/_jsxs(\"select\",{className:\"form-select form-select-sm\",style:{width:'auto'},value:pageSize,onChange:e=>{const newPageSize=Number(e.target.value);setPageSize(newPageSize);setCurrentPage(1);if(!hasFilters){fetchRoles(1,newPageSize);}},children:[/*#__PURE__*/_jsx(\"option\",{value:4,children:\"4\"}),/*#__PURE__*/_jsx(\"option\",{value:10,children:\"10\"}),/*#__PURE__*/_jsx(\"option\",{value:20,children:\"20\"}),/*#__PURE__*/_jsx(\"option\",{value:50,children:\"50\"})]})]})]}),/*#__PURE__*/_jsx(\"nav\",{children:/*#__PURE__*/_jsxs(\"ul\",{className:\"pagination pagination-sm mb-0\",children:[/*#__PURE__*/_jsx(\"li\",{className:\"page-item \".concat(currentPage===1?'disabled':''),children:/*#__PURE__*/_jsx(\"button\",{className:\"page-link\",onClick:()=>{setCurrentPage(1);if(!hasFilters){fetchRoles(1,pageSize);}},disabled:currentPage===1,children:/*#__PURE__*/_jsx(ChevronsLeft,{size:16})})}),/*#__PURE__*/_jsx(\"li\",{className:\"page-item \".concat(currentPage===1?'disabled':''),children:/*#__PURE__*/_jsx(\"button\",{className:\"page-link\",onClick:()=>{const newPage=currentPage-1;setCurrentPage(newPage);if(!hasFilters){fetchRoles(newPage,pageSize);}},disabled:currentPage===1,children:/*#__PURE__*/_jsx(ChevronLeft,{size:16})})}),Array.from({length:Math.min(5,displayTotalPages)},(_,i)=>{let pageNum;if(displayTotalPages<=5){pageNum=i+1;}else if(currentPage<=3){pageNum=i+1;}else if(currentPage>=displayTotalPages-2){pageNum=displayTotalPages-4+i;}else{pageNum=currentPage-2+i;}return/*#__PURE__*/_jsx(\"li\",{className:\"page-item \".concat(currentPage===pageNum?'active':''),children:/*#__PURE__*/_jsx(\"button\",{className:\"page-link\",onClick:()=>{setCurrentPage(pageNum);if(!hasFilters){fetchRoles(pageNum,pageSize);}},children:pageNum})},pageNum);}),/*#__PURE__*/_jsx(\"li\",{className:\"page-item \".concat(currentPage===displayTotalPages?'disabled':''),children:/*#__PURE__*/_jsx(\"button\",{className:\"page-link\",onClick:()=>{const newPage=currentPage+1;setCurrentPage(newPage);if(!hasFilters){fetchRoles(newPage,pageSize);}},disabled:currentPage===displayTotalPages,children:/*#__PURE__*/_jsx(ChevronRight,{size:16})})}),/*#__PURE__*/_jsx(\"li\",{className:\"page-item \".concat(currentPage===displayTotalPages?'disabled':''),children:/*#__PURE__*/_jsx(\"button\",{className:\"page-link\",onClick:()=>{setCurrentPage(displayTotalPages);if(!hasFilters){fetchRoles(displayTotalPages,pageSize);}},disabled:currentPage===displayTotalPages,children:/*#__PURE__*/_jsx(ChevronsRight,{size:16})})})]})})]})]})]})}),showRoleForm&&/*#__PURE__*/_jsx(\"div\",{className:\"modal d-block\",style:{backgroundColor:'rgba(0,0,0,0.5)',position:'fixed',top:0,left:0,width:'100%',height:'100%',zIndex:1050},children:/*#__PURE__*/_jsx(\"div\",{className:\"modal-dialog modal-dialog-centered\",style:{maxWidth:'90%',margin:'1.75rem auto'},children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content border-0 rounded-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header border-0 pb-0\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"modal-title fw-bold\",children:editingRole?'Edit Role':'Create New Role'}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn-close\",onClick:()=>{setShowRoleForm(false);setEditingRole(null);setSubmitSuccess(false);setRoleForm({roleName:''});}})]}),/*#__PURE__*/_jsx(\"div\",{className:\"modal-body\",children:submitSuccess?/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-4\",children:[/*#__PURE__*/_jsx(CheckCircle2,{size:64,className:\"text-success mb-3\"}),/*#__PURE__*/_jsx(\"h4\",{className:\"text-success fw-bold\",children:editingRole?'Role Updated Successfully!':'Role Created Successfully!'}),/*#__PURE__*/_jsx(\"p\",{className:\"text-muted\",children:editingRole?'The role has been updated.':'The new role has been created.'})]}):/*#__PURE__*/_jsx(\"div\",{className:\"row g-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"col-12\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"fw-bold mb-3\",children:\"Role Information\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label fw-semibold\",children:\"Role Name\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:roleForm.roleName,onChange:e=>setRoleForm(_objectSpread(_objectSpread({},roleForm),{},{roleName:e.target.value})),className:\"form-control rounded-3\",placeholder:\"Enter role name\",disabled:isSubmitting})]})]})})}),/*#__PURE__*/_jsx(\"div\",{className:\"modal-footer border-0 pt-0\",children:!submitSuccess&&/*#__PURE__*/_jsx(\"button\",{onClick:handleRoleSubmit,className:\"btn btn-primary rounded-3 fw-semibold d-flex align-items-center\",disabled:!roleForm.roleName.trim()||isSubmitting,children:isSubmitting?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Loader,{className:\"me-2 animate-spin\",size:16}),editingRole?'Updating...':'Creating...']}):editingRole?'Update Role':'Create Role'})})]})})}),showDeleteConfirm&&deletingRole&&/*#__PURE__*/_jsx(\"div\",{className:\"modal d-block\",style:{backgroundColor:'rgba(0,0,0,0.5)',position:'fixed',top:0,left:0,width:'100%',height:'100%',zIndex:1050},children:/*#__PURE__*/_jsx(\"div\",{className:\"modal-dialog modal-dialog-centered\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content border-0 rounded-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header border-0 pb-0\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"modal-title fw-bold text-danger\",children:deleteSuccess?'Role Deleted':'Confirm Deletion'}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn-close\",onClick:()=>{setShowDeleteConfirm(false);setDeletingRole(null);setDeleteSuccess(false);}})]}),/*#__PURE__*/_jsx(\"div\",{className:\"modal-body\",children:deleteSuccess?/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-4\",children:[/*#__PURE__*/_jsx(CheckCircle2,{size:64,className:\"text-success mb-3\"}),/*#__PURE__*/_jsx(\"h4\",{className:\"text-success fw-bold\",children:\"Role Deleted Successfully!\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-muted\",children:[/*#__PURE__*/_jsx(\"strong\",{children:deletingRole.role}),\" has been permanently removed.\"]})]}):/*#__PURE__*/_jsx(\"div\",{className:\"text-center py-4\",children:loadingConstraints?/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Loader,{size:64,className:\"text-primary mb-3\",style:{animation:'spin 2s linear infinite'}}),/*#__PURE__*/_jsx(\"h4\",{className:\"fw-bold\",children:\"Checking role constraints...\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-muted\",children:\"Please wait while we verify if this role can be deleted.\"})]}):(deletionConstraints===null||deletionConstraints===void 0?void 0:deletionConstraints.canDelete)===false?/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(AlertCircle,{size:64,className:\"text-danger mb-3\"}),/*#__PURE__*/_jsx(\"h4\",{className:\"fw-bold text-danger\",children:\"Cannot Delete Role\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-light rounded-3 p-3 my-3\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"fw-bold text-dark mb-1\",children:deletingRole.role}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-muted small mb-0\",children:[\"Created by \",deletingRole.createdBy,\" on \",new Date(deletingRole.createdAt).toLocaleDateString()]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"alert alert-danger text-start\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"fw-semibold mb-2\",children:\"Deletion blocked due to:\"}),deletionConstraints.usersCount>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-2\",children:[\"\\u2022 \",/*#__PURE__*/_jsx(\"strong\",{children:deletionConstraints.usersCount}),\" user\",deletionConstraints.usersCount>1?'s are':' is',\" assigned this role\"]}),deletionConstraints.temporaryUsersCount>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-2\",children:[\"\\u2022 \",/*#__PURE__*/_jsx(\"strong\",{children:deletionConstraints.temporaryUsersCount}),\" temporary user\",deletionConstraints.temporaryUsersCount>1?'s':'',\" will be assigned this role upon activation\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"small text-muted mt-2\",children:\"Please reassign users to different roles before deletion.\"})]})]}):/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(AlertTriangle,{size:64,className:\"text-warning mb-3\"}),/*#__PURE__*/_jsx(\"h4\",{className:\"fw-bold\",children:\"Are you sure you want to delete this role?\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-light rounded-3 p-3 my-3\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"fw-bold text-dark mb-1\",children:deletingRole.role}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-muted small mb-0\",children:[\"Created by \",deletingRole.createdBy,\" on \",new Date(deletingRole.createdAt).toLocaleDateString()]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"alert alert-success text-start\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"fw-semibold mb-1\",children:\"\\u2713 Safe to delete\"}),/*#__PURE__*/_jsx(\"div\",{className:\"small\",children:\"This role is not assigned to any users and can be safely removed.\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-danger small fw-semibold\",children:\"\\u26A0\\uFE0F This action cannot be undone.\"})]})})}),!deleteSuccess&&/*#__PURE__*/_jsxs(\"div\",{className:\"modal-footer border-0 pt-0\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setShowDeleteConfirm(false);setDeletingRole(null);setDeletionConstraints(null);},className:\"btn btn-secondary rounded-3 fw-semibold\",children:(deletionConstraints===null||deletionConstraints===void 0?void 0:deletionConstraints.canDelete)===false?'Close':'Cancel'}),(!deletionConstraints||deletionConstraints.canDelete===true)&&/*#__PURE__*/_jsxs(\"button\",{onClick:deleteRole,disabled:loadingConstraints||(deletionConstraints===null||deletionConstraints===void 0?void 0:deletionConstraints.canDelete)===false,className:\"btn btn-danger rounded-3 fw-semibold d-flex align-items-center\",children:[/*#__PURE__*/_jsx(Trash2,{className:\"me-2\",size:16}),\"Delete Role\"]})]})]})})})]})});};export default Roles;","map":{"version":3,"names":["React","useState","useEffect","Shield","Plus","Trash2","Key","CheckCircle2","AlertCircle","Loader","AlertTriangle","ChevronLeft","ChevronRight","ChevronsLeft","ChevronsRight","Search","roleApi","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Roles","roles","setRoles","allRoles","setAllRoles","loading","setLoading","showRoleForm","setShowRoleForm","editingRole","setEditingRole","isSubmitting","setIsSubmitting","submitSuccess","setSubmitSuccess","showDeleteConfirm","setShowDeleteConfirm","deletingRole","setDeletingRole","deleteSuccess","setDeleteSuccess","deletionConstraints","setDeletionConstraints","loadingConstraints","setLoadingConstraints","currentPage","setCurrentPage","pageSize","setPageSize","totalCount","setTotalCount","totalPages","setTotalPages","searchTerm","setSearchTerm","sortOrder","setSortOrder","roleForm","setRoleForm","roleName","fetchAllRoles","_response$data","response","getAllRoles","success","data","error","console","fetchRoles","page","arguments","length","undefined","size","_response$data2","log","startIndex","endIndex","paginatedRoles","slice","Math","ceil","refetchRoles","_response$data3","totalItems","newTotalPages","refetchAndGoToFirstPage","handleEscapeKey","event","key","document","addEventListener","removeEventListener","handleRoleSubmit","updateRole","userRoleId","alert","message","createRole","deleteRole","confirmDeleteRole","role","getRoleDeletionConstraints","canDelete","usersCount","temporaryUsersCount","constraintMessage","openEditRole","hasFilters","sourceRoles","filteredRoles","filter","matchesSearch","toLowerCase","includes","createdBy","sortedRoles","sort","a","b","dateA","Date","createdAt","getTime","dateB","currentRoles","displayTotalPages","displayTotalCount","className","style","overflowX","children","maxWidth","onClick","type","placeholder","value","onChange","e","target","newSortOrder","map","cursor","wordWrap","overflowWrap","toLocaleDateString","stopPropagation","title","concat","min","width","newPageSize","Number","disabled","newPage","Array","from","_","i","pageNum","backgroundColor","position","top","left","height","zIndex","margin","_objectSpread","trim","animation"],"sources":["/Users/jaili/csharpProject/Prototype/Prototype/ClientApp/src/components/roles/Roles.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Shield, Plus, Edit, Trash2, Users, Key, CheckCircle2, AlertCircle, Loader, AlertTriangle, ChevronLeft, ChevronRight, ChevronsLeft, ChevronsRight, Search } from 'lucide-react';\nimport { roleApi } from '../../services/api';\n\ninterface Role {\n    userRoleId: string;\n    role: string;\n    createdAt: string;\n    createdBy: string;\n}\n\nconst Roles: React.FC = () => {\n    const [roles, setRoles] = useState<Role[]>([]);\n    const [allRoles, setAllRoles] = useState<Role[]>([]); // Store all roles for client-side operations\n    const [loading, setLoading] = useState(false);\n    const [showRoleForm, setShowRoleForm] = useState(false);\n    const [editingRole, setEditingRole] = useState<Role | null>(null);\n    const [isSubmitting, setIsSubmitting] = useState(false);\n    const [submitSuccess, setSubmitSuccess] = useState(false);\n    const [showDeleteConfirm, setShowDeleteConfirm] = useState(false);\n    const [deletingRole, setDeletingRole] = useState<Role | null>(null);\n    const [deleteSuccess, setDeleteSuccess] = useState(false);\n    const [deletionConstraints, setDeletionConstraints] = useState<{\n        canDelete: boolean;\n        usersCount: number;\n        temporaryUsersCount: number;\n        constraintMessage: string;\n        roleName: string;\n    } | null>(null);\n    const [loadingConstraints, setLoadingConstraints] = useState(false);\n\n    // Pagination state\n    const [currentPage, setCurrentPage] = useState(1);\n    const [pageSize, setPageSize] = useState(4);\n    const [totalCount, setTotalCount] = useState(0);\n    const [totalPages, setTotalPages] = useState(0);\n\n    // Search and sorting state\n    const [searchTerm, setSearchTerm] = useState('');\n    const [sortOrder, setSortOrder] = useState<'newest' | 'oldest'>('newest');\n\n    const [roleForm, setRoleForm] = useState({\n        roleName: ''\n    });\n\n    const fetchAllRoles = async () => {\n        try {\n            // Fetch all roles by requesting a large page size\n            const response = await roleApi.getAllRoles(1, 1000); // Large enough to get all\n            if (response.success && response.data?.data) {\n                setAllRoles(response.data.data);\n                return response.data.data;\n            } else if (response.success && response.roles) {\n                setAllRoles(response.roles);\n                return response.roles;\n            }\n            return [];\n        } catch (error) {\n            console.error('Failed to fetch all roles:', error);\n            return [];\n        }\n    };\n\n    const fetchRoles = async (page: number = currentPage, size: number = pageSize) => {\n        setLoading(true);\n        try {\n            console.log('Fetching roles...');\n            const response = await roleApi.getAllRoles(page, size);\n            console.log('Fetch roles response:', response);\n            if (response.success && response.data?.data) {\n                console.log('Setting roles:', response.data.data);\n                setRoles(response.data.data);\n                setCurrentPage(response.data.page || page);\n                setPageSize(response.data.pageSize || size);\n                setTotalCount(response.data.totalCount || 0);\n                setTotalPages(response.data.totalPages || 1);\n            } else if (response.success && response.roles) {\n                // Fallback for old API response format - use client-side pagination\n                console.log('Setting roles (fallback):', response.roles);\n                const startIndex = (page - 1) * size;\n                const endIndex = startIndex + size;\n                const paginatedRoles = response.roles.slice(startIndex, endIndex);\n                setRoles(paginatedRoles);\n                // Set pagination values for non-paginated response\n                setTotalCount(response.roles.length);\n                setTotalPages(Math.ceil(response.roles.length / size));\n                setCurrentPage(page);\n                setPageSize(size);\n            } else {\n                console.log('No roles returned or response not successful');\n            }\n        } catch (error) {\n            console.error('Failed to fetch roles:', error);\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    // Smart refetch that handles empty pages after deletion\n    const refetchRoles = async () => {\n        // First, check the current state after deletion\n        const response = await roleApi.getAllRoles(currentPage, pageSize);\n        if (response.success) {\n            let totalItems = 0;\n            if (response.data?.totalCount !== undefined) {\n                totalItems = response.data.totalCount;\n            } else if (response.roles) {\n                totalItems = response.roles.length;\n            }\n            \n            const newTotalPages = Math.ceil(totalItems / pageSize);\n            \n            // Check if current page is beyond available pages\n            if (currentPage > newTotalPages && totalItems > 0) {\n                // Navigate to last available page\n                setCurrentPage(newTotalPages);\n                await fetchRoles(newTotalPages, pageSize);\n            } else if (totalItems === 0) {\n                // If no roles at all, go to page 1\n                setCurrentPage(1);\n                await fetchRoles(1, pageSize);\n            } else {\n                // Current page is valid, just refresh\n                await fetchRoles(currentPage, pageSize);\n            }\n        } else {\n            // If the request failed, just refresh current page\n            await fetchRoles(currentPage, pageSize);\n        }\n        // Also refresh all roles\n        await fetchAllRoles();\n    };\n\n    // Refetch and navigate to first page (where new items should appear)\n    const refetchAndGoToFirstPage = async () => {\n        setCurrentPage(1);\n        await fetchRoles(1, pageSize);\n        // Also refresh all roles\n        await fetchAllRoles();\n    };\n\n    useEffect(() => {\n        fetchRoles(1, pageSize);\n        // Also fetch all roles for client-side operations\n        fetchAllRoles();\n    }, []);\n\n    // Add escape key listener to close modals\n    useEffect(() => {\n        const handleEscapeKey = (event: KeyboardEvent) => {\n            if (event.key === 'Escape') {\n                if (showRoleForm) {\n                    setShowRoleForm(false);\n                    setEditingRole(null);\n                    setRoleForm({ roleName: '' });\n                }\n            }\n        };\n\n        document.addEventListener('keydown', handleEscapeKey);\n        return () => {\n            document.removeEventListener('keydown', handleEscapeKey);\n        };\n    }, [showRoleForm]);\n\n    const handleRoleSubmit = async () => {\n        try {\n            setIsSubmitting(true);\n            if (editingRole) {\n                // Update existing role\n                const response = await roleApi.updateRole(editingRole.userRoleId, { roleName: roleForm.roleName });\n                if (response.success) {\n                    setSubmitSuccess(true);\n                    refetchRoles(); // Stay on current page when editing\n                    \n                    // Role form will be closed manually by user clicking X\n                } else {\n                    alert(response.message || 'Failed to update role');\n                }\n            } else {\n                // Create new role\n                console.log('Creating role with name:', roleForm.roleName);\n                const response = await roleApi.createRole({ roleName: roleForm.roleName });\n                console.log('Create role response:', response);\n                if (response.success) {\n                    setSubmitSuccess(true);\n                    console.log('Fetching roles after creation...');\n                    refetchAndGoToFirstPage(); // Go to first page where new role should appear\n                    \n                    // Role form will be closed manually by user clicking X\n                } else {\n                    alert(response.message || 'Failed to create role');\n                }\n            }\n        } catch (error: any) {\n            console.error('Failed to save role:', error);\n            alert(error.message || 'Failed to save role');\n        } finally {\n            setIsSubmitting(false);\n        }\n    };\n\n    const deleteRole = async () => {\n        if (!deletingRole) return;\n\n        try {\n            const response = await roleApi.deleteRole(deletingRole.userRoleId);\n            if (response.success) {\n                setDeleteSuccess(true);\n                refetchRoles();\n                \n                // Delete success modal will be closed manually by user clicking X\n            } else {\n                alert(response.message || 'Failed to delete role');\n            }\n        } catch (error: any) {\n            console.error('Failed to delete role:', error);\n            alert(error.message || 'Failed to delete role');\n        }\n    };\n\n    const confirmDeleteRole = async (role: Role) => {\n        setDeletingRole(role);\n        setShowDeleteConfirm(true);\n        setLoadingConstraints(true);\n        setDeletionConstraints(null);\n        \n        try {\n            const response = await roleApi.getRoleDeletionConstraints(role.userRoleId);\n            if (response.success) {\n                setDeletionConstraints({\n                    canDelete: response.canDelete,\n                    usersCount: response.usersCount,\n                    temporaryUsersCount: response.temporaryUsersCount,\n                    constraintMessage: response.constraintMessage,\n                    roleName: response.roleName\n                });\n            }\n        } catch (error) {\n            console.error('Failed to fetch deletion constraints:', error);\n            setDeletionConstraints({\n                canDelete: false,\n                usersCount: 0,\n                temporaryUsersCount: 0,\n                constraintMessage: \"Unable to check role constraints. Please try again.\",\n                roleName: role.role\n            });\n        } finally {\n            setLoadingConstraints(false);\n        }\n    };\n\n\n    const openEditRole = (role: Role) => {\n        setEditingRole(role);\n        setRoleForm({\n            roleName: role.role\n        });\n        setShowRoleForm(true);\n    };\n\n    // Use filtered/sorted roles for display (when filters are active)\n    // Use backend pagination when no filters are applied\n    const hasFilters = searchTerm !== '' || sortOrder === 'oldest';\n    \n    // Use allRoles for filtering/sorting, roles for backend pagination\n    const sourceRoles = hasFilters ? allRoles : roles;\n    \n    // Filter and sort roles\n    const filteredRoles = sourceRoles.filter(role => {\n        const matchesSearch = searchTerm === '' || \n                             role.role.toLowerCase().includes(searchTerm.toLowerCase()) ||\n                             role.createdBy.toLowerCase().includes(searchTerm.toLowerCase());\n        return matchesSearch;\n    });\n\n    // Sort roles based on creation date\n    const sortedRoles = [...filteredRoles].sort((a, b) => {\n        const dateA = new Date(a.createdAt).getTime();\n        const dateB = new Date(b.createdAt).getTime();\n        return sortOrder === 'newest' ? dateB - dateA : dateA - dateB;\n    });\n    \n    let currentRoles: Role[], displayTotalPages: number, displayTotalCount: number;\n    if (hasFilters) {\n        // Client-side pagination for filtered results\n        const startIndex = (currentPage - 1) * pageSize;\n        const endIndex = startIndex + pageSize;\n        currentRoles = sortedRoles.slice(startIndex, endIndex);\n        displayTotalPages = Math.ceil(sortedRoles.length / pageSize);\n        displayTotalCount = sortedRoles.length;\n    } else {\n        // Backend pagination for unfiltered results\n        currentRoles = roles;\n        displayTotalPages = totalPages;\n        displayTotalCount = totalCount;\n    }\n\n    return (\n        <div className=\"min-vh-100 bg-light\" style={{overflowX: 'hidden'}}>\n            <div className=\"container-fluid py-4\" style={{maxWidth: '100%'}}>\n                {/* Header */}\n                <div className=\"mb-4\">\n                    <div className=\"d-flex align-items-center mb-2\">\n                        <Shield className=\"text-primary me-3\" size={32} />\n                        <h1 className=\"display-5 fw-bold text-dark mb-0\">Roles</h1>\n                    </div>\n                    <p className=\"text-muted fs-6\">Manage user roles and their permissions</p>\n                </div>\n\n                {/* Roles */}\n                <div className=\"card shadow-sm border-0 rounded-4\">\n                    <div className=\"card-body p-4\">\n                        <div className=\"d-flex justify-content-between align-items-center mb-4\">\n                            <h2 className=\"card-title fw-bold text-dark mb-0 d-flex align-items-center\">\n                                <Key className=\"text-primary me-2\" size={24} />\n                                System Roles\n                            </h2>\n                            <button\n                                onClick={() => setShowRoleForm(true)}\n                                className=\"btn btn-primary rounded-3 fw-semibold d-flex align-items-center\"\n                            >\n                                <Plus className=\"me-2\" size={18} />\n                                <span>Create Role</span>\n                            </button>\n                        </div>\n\n                        {/* Search and Sort Controls */}\n                        <div className=\"row g-3 mb-4\">\n                            <div className=\"col-md-8\">\n                                <div className=\"position-relative\">\n                                    <Search className=\"position-absolute top-50 start-0 translate-middle-y ms-3 text-muted\" size={16} />\n                                    <input\n                                        type=\"text\"\n                                        className=\"form-control rounded-3 ps-5\"\n                                        placeholder=\"Search roles...\"\n                                        value={searchTerm}\n                                        onChange={(e) => {\n                                            setSearchTerm(e.target.value);\n                                            setCurrentPage(1); // Reset to first page when searching\n                                        }}\n                                    />\n                                </div>\n                            </div>\n                            <div className=\"col-md-4\">\n                                <select\n                                    className=\"form-select rounded-3\"\n                                    value={sortOrder}\n                                    onChange={async (e) => {\n                                        const newSortOrder = e.target.value as 'newest' | 'oldest';\n                                        setSortOrder(newSortOrder);\n                                        setCurrentPage(1); // Reset to first page when sorting changes\n                                        \n                                        // If switching to oldest first and we don't have all roles, fetch them\n                                        if (newSortOrder === 'oldest' && allRoles.length === 0) {\n                                            await fetchAllRoles();\n                                        }\n                                    }}\n                                >\n                                    <option value=\"newest\">Newest First</option>\n                                    <option value=\"oldest\">Oldest First</option>\n                                </select>\n                            </div>\n                        </div>\n\n                        {loading ? (\n                            <div className=\"d-flex align-items-center text-muted\">\n                                <div className=\"spinner-border spinner-border-sm me-2\" role=\"status\">\n                                    <span className=\"visually-hidden\">Loading...</span>\n                                </div>\n                                Loading roles...\n                            </div>\n                        ) : (\n                            <>\n                                <div className=\"row g-3\">\n                                    {currentRoles.map((role) => (\n                                        <div key={role.userRoleId} className=\"col-12\">\n                                            <div \n                                                className=\"card border border-light rounded-3 h-100\" \n                                                style={{cursor: 'pointer'}}\n                                                onClick={() => openEditRole(role)}\n                                            >\n                                                <div className=\"card-body p-4\">\n                                                    <div className=\"d-flex justify-content-between align-items-start mb-3\">\n                                                        <div className=\"flex-grow-1\">\n                                                            <h5 className=\"card-title fw-bold text-dark mb-1 d-flex align-items-center\" style={{wordWrap: 'break-word', overflowWrap: 'break-word'}}>\n                                                                {role.role}\n                                                                <CheckCircle2 className=\"text-success ms-2\" size={16} />\n                                                            </h5>\n                                                            <p className=\"card-text text-muted small mb-2\">\n                                                                Created by {role.createdBy} on {new Date(role.createdAt).toLocaleDateString()}\n                                                            </p>\n                                                        </div>\n                                                        <div className=\"d-flex flex-column gap-1\">\n                                                            <button\n                                                                onClick={(e) => {\n                                                                    e.stopPropagation();\n                                                                    confirmDeleteRole(role);\n                                                                }}\n                                                                className=\"btn btn-outline-danger btn-sm rounded-3\"\n                                                                title=\"Delete Role\"\n                                                            >\n                                                                <Trash2 size={14} />\n                                                            </button>\n                                                        </div>\n                                                    </div>\n                                                </div>\n                                            </div>\n                                        </div>\n                                    ))}\n                                    {currentRoles.length === 0 && !loading && (\n                                        <div className=\"col-12\">\n                                            <div className=\"text-center py-5 text-muted\">\n                                                <Shield size={48} className=\"mb-3 opacity-50\" />\n                                                <p>{hasFilters ? 'No roles match your search' : 'No roles configured yet'}</p>\n                                            </div>\n                                        </div>\n                                    )}\n                                </div>\n\n                                {/* Pagination */}\n                                {displayTotalCount > 4 && (\n                            <div className=\"d-flex justify-content-between align-items-center mt-4\">\n                                <div className=\"d-flex align-items-center gap-3\">\n                                    <span className=\"text-muted\">\n                                        {hasFilters ? (\n                                            `Showing ${currentRoles.length} of ${displayTotalCount} roles (filtered)`\n                                        ) : (\n                                            `Showing ${((currentPage - 1) * pageSize) + 1} to ${Math.min(currentPage * pageSize, displayTotalCount)} of ${displayTotalCount} roles`\n                                        )}\n                                    </span>\n                                    <div className=\"d-flex align-items-center gap-2\">\n                                        <span className=\"text-muted small\">Roles per page:</span>\n                                        <select \n                                            className=\"form-select form-select-sm\" \n                                            style={{width: 'auto'}}\n                                            value={pageSize}\n                                            onChange={(e) => {\n                                                const newPageSize = Number(e.target.value);\n                                                setPageSize(newPageSize);\n                                                setCurrentPage(1);\n                                                if (!hasFilters) {\n                                                    fetchRoles(1, newPageSize);\n                                                }\n                                            }}\n                                        >\n                                            <option value={4}>4</option>\n                                            <option value={10}>10</option>\n                                            <option value={20}>20</option>\n                                            <option value={50}>50</option>\n                                        </select>\n                                    </div>\n                                </div>\n                                \n                                <nav>\n                                    <ul className=\"pagination pagination-sm mb-0\">\n                                        <li className={`page-item ${currentPage === 1 ? 'disabled' : ''}`}>\n                                            <button \n                                                className=\"page-link\" \n                                                onClick={() => {\n                                                    setCurrentPage(1);\n                                                    if (!hasFilters) {\n                                                        fetchRoles(1, pageSize);\n                                                    }\n                                                }}\n                                                disabled={currentPage === 1}\n                                            >\n                                                <ChevronsLeft size={16} />\n                                            </button>\n                                        </li>\n                                        <li className={`page-item ${currentPage === 1 ? 'disabled' : ''}`}>\n                                            <button \n                                                className=\"page-link\" \n                                                onClick={() => {\n                                                    const newPage = currentPage - 1;\n                                                    setCurrentPage(newPage);\n                                                    if (!hasFilters) {\n                                                        fetchRoles(newPage, pageSize);\n                                                    }\n                                                }}\n                                                disabled={currentPage === 1}\n                                            >\n                                                <ChevronLeft size={16} />\n                                            </button>\n                                        </li>\n                                        \n                                        {/* Page numbers */}\n                                        {Array.from({ length: Math.min(5, displayTotalPages) }, (_, i) => {\n                                            let pageNum: number;\n                                            if (displayTotalPages <= 5) {\n                                                pageNum = i + 1;\n                                            } else if (currentPage <= 3) {\n                                                pageNum = i + 1;\n                                            } else if (currentPage >= displayTotalPages - 2) {\n                                                pageNum = displayTotalPages - 4 + i;\n                                            } else {\n                                                pageNum = currentPage - 2 + i;\n                                            }\n                                            \n                                            return (\n                                                <li key={pageNum} className={`page-item ${currentPage === pageNum ? 'active' : ''}`}>\n                                                    <button \n                                                        className=\"page-link\" \n                                                        onClick={() => {\n                                                            setCurrentPage(pageNum);\n                                                            if (!hasFilters) {\n                                                                fetchRoles(pageNum, pageSize);\n                                                            }\n                                                        }}\n                                                    >\n                                                        {pageNum}\n                                                    </button>\n                                                </li>\n                                            );\n                                        })}\n                                        \n                                        <li className={`page-item ${currentPage === displayTotalPages ? 'disabled' : ''}`}>\n                                            <button \n                                                className=\"page-link\" \n                                                onClick={() => {\n                                                    const newPage = currentPage + 1;\n                                                    setCurrentPage(newPage);\n                                                    if (!hasFilters) {\n                                                        fetchRoles(newPage, pageSize);\n                                                    }\n                                                }}\n                                                disabled={currentPage === displayTotalPages}\n                                            >\n                                                <ChevronRight size={16} />\n                                            </button>\n                                        </li>\n                                        <li className={`page-item ${currentPage === displayTotalPages ? 'disabled' : ''}`}>\n                                            <button \n                                                className=\"page-link\" \n                                                onClick={() => {\n                                                    setCurrentPage(displayTotalPages);\n                                                    if (!hasFilters) {\n                                                        fetchRoles(displayTotalPages, pageSize);\n                                                    }\n                                                }}\n                                                disabled={currentPage === displayTotalPages}\n                                            >\n                                                <ChevronsRight size={16} />\n                                            </button>\n                                        </li>\n                                    </ul>\n                                </nav>\n                            </div>\n                        )}\n                            </>\n                        )}\n                    </div>\n                </div>\n\n                {/* Role Form Modal */}\n                {showRoleForm && (\n                    <div className=\"modal d-block\" style={{backgroundColor: 'rgba(0,0,0,0.5)', position: 'fixed', top: 0, left: 0, width: '100%', height: '100%', zIndex: 1050}}>\n                        <div className=\"modal-dialog modal-dialog-centered\" style={{maxWidth: '90%', margin: '1.75rem auto'}}>\n                            <div className=\"modal-content border-0 rounded-4\">\n                                <div className=\"modal-header border-0 pb-0\">\n                                    <h3 className=\"modal-title fw-bold\">\n                                        {editingRole ? 'Edit Role' : 'Create New Role'}\n                                    </h3>\n                                    <button\n                                        type=\"button\"\n                                        className=\"btn-close\"\n                                        onClick={() => {\n                                            setShowRoleForm(false);\n                                            setEditingRole(null);\n                                            setSubmitSuccess(false);\n                                            setRoleForm({\n                                                roleName: ''\n                                            });\n                                        }}\n                                    ></button>\n                                </div>\n                                <div className=\"modal-body\">\n                                    {submitSuccess ? (\n                                        <div className=\"text-center py-4\">\n                                            <CheckCircle2 size={64} className=\"text-success mb-3\" />\n                                            <h4 className=\"text-success fw-bold\">\n                                                {editingRole ? 'Role Updated Successfully!' : 'Role Created Successfully!'}\n                                            </h4>\n                                            <p className=\"text-muted\">\n                                                {editingRole ? 'The role has been updated.' : 'The new role has been created.'}\n                                            </p>\n                                        </div>\n                                    ) : (\n                                        <div className=\"row g-4\">\n                                            <div className=\"col-12\">\n                                                <h5 className=\"fw-bold mb-3\">Role Information</h5>\n                                                <div className=\"mb-3\">\n                                                    <label className=\"form-label fw-semibold\">Role Name</label>\n                                                    <input\n                                                        type=\"text\"\n                                                        value={roleForm.roleName}\n                                                        onChange={(e) => setRoleForm({...roleForm, roleName: e.target.value})}\n                                                        className=\"form-control rounded-3\"\n                                                        placeholder=\"Enter role name\"\n                                                        disabled={isSubmitting}\n                                                    />\n                                                </div>\n                                            </div>\n                                        </div>\n                                    )}\n                                </div>\n                                <div className=\"modal-footer border-0 pt-0\">\n                                    {!submitSuccess && (\n                                        <button\n                                            onClick={handleRoleSubmit}\n                                            className=\"btn btn-primary rounded-3 fw-semibold d-flex align-items-center\"\n                                            disabled={!roleForm.roleName.trim() || isSubmitting}\n                                        >\n                                            {isSubmitting ? (\n                                                <>\n                                                    <Loader className=\"me-2 animate-spin\" size={16} />\n                                                    {editingRole ? 'Updating...' : 'Creating...'}\n                                                </>\n                                            ) : (\n                                                editingRole ? 'Update Role' : 'Create Role'\n                                            )}\n                                        </button>\n                                    )}\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                )}\n\n                {/* Delete Confirmation Modal */}\n                {showDeleteConfirm && deletingRole && (\n                    <div className=\"modal d-block\" style={{backgroundColor: 'rgba(0,0,0,0.5)', position: 'fixed', top: 0, left: 0, width: '100%', height: '100%', zIndex: 1050}}>\n                        <div className=\"modal-dialog modal-dialog-centered\">\n                            <div className=\"modal-content border-0 rounded-4\">\n                                <div className=\"modal-header border-0 pb-0\">\n                                    <h3 className=\"modal-title fw-bold text-danger\">\n                                        {deleteSuccess ? 'Role Deleted' : 'Confirm Deletion'}\n                                    </h3>\n                                    <button\n                                        type=\"button\"\n                                        className=\"btn-close\"\n                                        onClick={() => {\n                                            setShowDeleteConfirm(false);\n                                            setDeletingRole(null);\n                                            setDeleteSuccess(false);\n                                        }}\n                                    ></button>\n                                </div>\n                                <div className=\"modal-body\">\n                                    {deleteSuccess ? (\n                                        <div className=\"text-center py-4\">\n                                            <CheckCircle2 size={64} className=\"text-success mb-3\" />\n                                            <h4 className=\"text-success fw-bold\">Role Deleted Successfully!</h4>\n                                            <p className=\"text-muted\">\n                                                <strong>{deletingRole.role}</strong> has been permanently removed.\n                                            </p>\n                                        </div>\n                                    ) : (\n                                        <div className=\"text-center py-4\">\n                                            {loadingConstraints ? (\n                                                <div>\n                                                    <Loader size={64} className=\"text-primary mb-3\" style={{animation: 'spin 2s linear infinite'}} />\n                                                    <h4 className=\"fw-bold\">Checking role constraints...</h4>\n                                                    <p className=\"text-muted\">Please wait while we verify if this role can be deleted.</p>\n                                                </div>\n                                            ) : deletionConstraints?.canDelete === false ? (\n                                                <div>\n                                                    <AlertCircle size={64} className=\"text-danger mb-3\" />\n                                                    <h4 className=\"fw-bold text-danger\">Cannot Delete Role</h4>\n                                                    <div className=\"bg-light rounded-3 p-3 my-3\">\n                                                        <h5 className=\"fw-bold text-dark mb-1\">{deletingRole.role}</h5>\n                                                        <p className=\"text-muted small mb-0\">Created by {deletingRole.createdBy} on {new Date(deletingRole.createdAt).toLocaleDateString()}</p>\n                                                    </div>\n                                                    <div className=\"alert alert-danger text-start\">\n                                                        <div className=\"fw-semibold mb-2\">Deletion blocked due to:</div>\n                                                        {deletionConstraints.usersCount > 0 && (\n                                                            <div className=\"mb-2\">\n                                                                 <strong>{deletionConstraints.usersCount}</strong> user{deletionConstraints.usersCount > 1 ? 's are' : ' is'} assigned this role\n                                                            </div>\n                                                        )}\n                                                        {deletionConstraints.temporaryUsersCount > 0 && (\n                                                            <div className=\"mb-2\">\n                                                                 <strong>{deletionConstraints.temporaryUsersCount}</strong> temporary user{deletionConstraints.temporaryUsersCount > 1 ? 's' : ''} will be assigned this role upon activation\n                                                            </div>\n                                                        )}\n                                                        <div className=\"small text-muted mt-2\">\n                                                            Please reassign users to different roles before deletion.\n                                                        </div>\n                                                    </div>\n                                                </div>\n                                            ) : (\n                                                <div>\n                                                    <AlertTriangle size={64} className=\"text-warning mb-3\" />\n                                                    <h4 className=\"fw-bold\">Are you sure you want to delete this role?</h4>\n                                                    <div className=\"bg-light rounded-3 p-3 my-3\">\n                                                        <h5 className=\"fw-bold text-dark mb-1\">{deletingRole.role}</h5>\n                                                        <p className=\"text-muted small mb-0\">Created by {deletingRole.createdBy} on {new Date(deletingRole.createdAt).toLocaleDateString()}</p>\n                                                    </div>\n                                                    <div className=\"alert alert-success text-start\">\n                                                        <div className=\"fw-semibold mb-1\"> Safe to delete</div>\n                                                        <div className=\"small\">This role is not assigned to any users and can be safely removed.</div>\n                                                    </div>\n                                                    <p className=\"text-danger small fw-semibold\">\n                                                         This action cannot be undone.\n                                                    </p>\n                                                </div>\n                                            )}\n                                        </div>\n                                    )}\n                                </div>\n                                {!deleteSuccess && (\n                                    <div className=\"modal-footer border-0 pt-0\">\n                                        <button\n                                            onClick={() => {\n                                                setShowDeleteConfirm(false);\n                                                setDeletingRole(null);\n                                                setDeletionConstraints(null);\n                                            }}\n                                            className=\"btn btn-secondary rounded-3 fw-semibold\"\n                                        >\n                                            {deletionConstraints?.canDelete === false ? 'Close' : 'Cancel'}\n                                        </button>\n                                        {(!deletionConstraints || deletionConstraints.canDelete === true) && (\n                                            <button\n                                                onClick={deleteRole}\n                                                disabled={loadingConstraints || deletionConstraints?.canDelete === false}\n                                                className=\"btn btn-danger rounded-3 fw-semibold d-flex align-items-center\"\n                                            >\n                                                <Trash2 className=\"me-2\" size={16} />\n                                                Delete Role\n                                            </button>\n                                        )}\n                                    </div>\n                                )}\n                            </div>\n                        </div>\n                    </div>\n                )}\n            </div>\n        </div>\n    );\n};\n\nexport default Roles;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}